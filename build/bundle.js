(()=>{"use strict";class t{constructor(t){this.requests=[],t&&(this.host=t)}static getInstance(e){return t.instance||(t.instance=new t(e)),t.instance}async saveEvent(t,e){const s=Date.now();if(this.requests.push(s),1===this.requests.length)return void this.executeRequest(s,t,e);let n;n=setInterval((()=>{this.requests.indexOf(s)>0||(clearInterval(n),this.executeRequest(s,t,(t=>{e&&e(t)})))}),500)}async executeRequest(t,e,s){fetch(`${this.host}/event`,{method:"POST",body:JSON.stringify(e),headers:{"Content-type":"application/json",Accept:"application/json"}}).then((e=>{if(0===this.requests.indexOf(t)&&this.requests.shift(),200===e.status)return e.json().then((t=>{s&&s(t)}));429!==e.status?204!==e.status||s&&s({status:204}):console.error("Too many requests, please try again later.")}))}getUserData(t,e){fetch(`${this.host}/customer/${t}`).then((t=>{200==t.status&&t.json().then((t=>{e&&e(t)}))}))}}const e={cid:null,sid:null},s="cdplight",n="arrigoocdp",i=t=>{const i=t.getItem(s);return i&&(t.setItem(n,i),t.removeItem(s)),new Proxy(e,{set:(e,s,i)=>{const o=t.getItem(n);(e=o?JSON.parse(atob(o)):{})[s]=null===i?null:i;const r=btoa(JSON.stringify(e));return t.setItem(n,r),!0},get:(e,s)=>{const i=t.getItem(n);if(i&&(e=i?JSON.parse(atob(i)):{})[s])return e[s]}})};class o{constructor(t,e,s){this.sendInitEvent=()=>{const t=window.arrigooInit||{},e=(t=>{const e=window.location.search.matchAll(/([a-zA-Z]+)=([^&]+)/gi);let s;const n={};for(;(s=e.next())&&!s.done;)n[s.value[1]]=s.value[2];return n})(),s=e.source||(e.gclid?"ad":"web"),n={evt:"pageview",strval:e.campaign||"",intval:this.storage.pv,src:s,url:window.location.href,ref:document.referrer+"",...t};this.send("pageview",document.title,n)},window.arrigooInit=window.arrigooInit||{},this.init=window.arrigooInit,this.client=t,this.storage=i(e),this.storage.pv=this.storage.pv+1,this.storageTemp=i(s||sessionStorage)}set(t,e){this.init[t]=e}setIdentifier(t,e){this.init.ident={id_type:t,id_value:e}}get(t){return this.storageTemp[t]||this.storage[t]}getFullProfile(){return{cid:this.storage.cid,p:this.storageTemp.p,s:this.storageTemp.s,c:this.storageTemp.c}}unset(t){delete this.init[t]}getInit(){return this.init}getHashValues(){return window.location.hash}getSearchValue(t){return new URLSearchParams(window.location.search||"").get(t)}isrecognized(){const t=this.getFullProfile();if(!t.cid)return!1;const e=new CustomEvent("ao_recognized",{detail:t});return document.dispatchEvent(e),!0}setCidAndFirstVisit(){const t={fv:!1};return this.storage.cid||(this.storage.cid="",t.fv=!0),t.cid=this.storage.cid,t}setSession(t){this.storageTemp.sct=this.storageTemp.sct?this.storageTemp.sct+1:1;const e=this.storage.lastEvent||0;let s=this.storageTemp.sid;t.ns=!1;const n=Math.floor(Date.now()/1e3);return(!s||n-e>1800)&&(s=n,this.storageTemp.sid=s,t.ns=!0,this.storage.sct=1),this.storage.lastEvent=n,t.sid=s,t}consent(t,e){const s=this.setSession(this.setCidAndFirstVisit());let n=0;"GRANT"===t.status&&(n=1),"REVOKE"===t.status&&(n=-1);const i={evt:"consent",src:t.type,strval:t.scope,intval:n,url:window.location.href,topics:[t.type],sid:0,cid:this.storage.cid,...s};this.client.saveEvent(i,(t=>{e&&e(t)}))}send(t,e,s){let n={evt:t,strval:e||"",...this.setSession(this.setCidAndFirstVisit()),...s||{}};this.client.saveEvent(n,(t=>{if(t.p||t.s||t.c){const e=new CustomEvent("ao_recognized",{detail:t});this.storageTemp.s=t.s||[],this.storageTemp.p=t.p||{},this.storageTemp.c=t.c||{},document.dispatchEvent(e)}if(t.cid){this.storage.cid=t.cid;const e=new CustomEvent("ao_cid",{detail:t.cid});document.dispatchEvent(e)}const e=new CustomEvent("ao_event_sent",{detail:t});document.dispatchEvent(e)}))}}const r=t.getInstance(window.arrigooHost),a=new Event("ao_loaded");function c(){window.argo=new o(r,localStorage,sessionStorage),window.document.dispatchEvent(a),window.argo.isrecognized()}!function(){const t=document.createElement("style");t.textContent="\n    [data-cdp-segments] {\n        display: none;\n    }\n    ",document.head.appendChild(t)}();let d=!1;document.addEventListener("ao_recognized",(()=>{var t;t=window.argo.get("s"),document.querySelectorAll("[data-cdp-segments]").forEach((function(e){e.getAttribute("data-cdp-segments").split(" ").find((e=>t.indexOf(e)>-1))?e.style.display="block":e.remove()}))})),document.addEventListener("DOMContentLoaded",(()=>{c(),d=!0})),setTimeout((()=>{d||c()}),300)})();