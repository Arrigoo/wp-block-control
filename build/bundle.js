(()=>{"use strict";class t{constructor(t){this.host="http://localhost:3000",t&&(this.host=t)}static getInstance(s){return t.instance||(t.instance=new t(s)),t.instance}saveEvent(t,s){fetch(`${this.host}/event`,{method:"POST",body:JSON.stringify(t),headers:{"Content-type":"application/json",Accept:"application/json"}}).then((t=>{200==t.status&&t.json().then((t=>{s&&s(t)}))}))}getUserData(t,s){fetch(`${this.host}/customer/${t}`).then((t=>{200==t.status&&t.json().then((t=>{s&&s(t)}))}))}}const s={cid:null,sid:null},e="cdplight",i=t=>new Proxy(s,{set:(s,i,n)=>{const o=t.getItem(e);(s=o?JSON.parse(atob(o)):{})[i]=null===n?null:n;const a=btoa(JSON.stringify(s));return t.setItem(e,a),!0},get:(s,i)=>{const n=t.getItem(e);if(n&&(s=n?JSON.parse(atob(n)):{})[i])return s[i]}});class n{constructor(t,s,e){this.sendInitEvent=()=>{const t=window.argoinit||{},s=(t=>{const s=window.location.search.matchAll(/([a-zA-Z]+)=([^&]+)/gi);let e;const i={};for(;(e=s.next())&&!e.done;)i[e.value[1]]=e.value[2];return i})(),e=s.source||(s.gclid?"ad":"web"),i={evt:"pageview",strval:document.title,intval:this.storage.pv,src:e,url:window.location.href,ref:document.referrer+"",...t};this.send("pageview",document.title,i)},window.arrigooInit=window.arrigooInit||{},this.init=window.arrigooInit,this.client=t,this.storage=i(s),this.storage.pv=this.storage.pv+1,this.storageTemp=i(e||sessionStorage)}set(t,s){this.init[t]=s}get(t){return this.storageTemp[t]||this.storage[t]}getFullProfile(){return{cid:this.storage.cid,p:this.storageTemp.p,s:this.storageTemp.s,c:this.storageTemp.c}}unset(t){delete this.init[t]}getInit(){return this.init}getHashValues(){return window.location.hash}getSearchValue(t){return new URLSearchParams(window.location.search||"").get(t)}setCidAndFirstVisit(){const t={fv:!1};return this.storage.cid||(this.storage.cid="",t.fv=!0),t.cid=this.storage.cid,t}setSession(t){this.storage.sct=this.storage.sct?this.storage.sct+1:1;const s=this.storage.lastEvent||0;let e=this.storage.sid;t.ns=!1;const i=Math.floor(Date.now()/1e3);return(!e||i-s>1800)&&(e=i,this.storage.sid=e,t.ns=!0,this.storage.sct=1),this.storage.lastEvent=i,t.sid=e,t}consent(t,s){const e=this.setSession(this.setCidAndFirstVisit());let i=0;"GRANT"===t.status&&(i=1),"REVOKE"===t.status&&(i=-1);const n={evt:"consent",src:t.type,strval:t.scope,intval:i,url:window.location.href,topics:[t.type],sid:0,cid:this.storage.cid,...e};this.client.saveEvent(n,(t=>{s&&s(t)}))}send(t,s,e){let i={evt:t,strval:s||"",...this.setSession(this.setCidAndFirstVisit()),...e||{}};this.client.saveEvent(i,(t=>{if(t.p||t.s){const s=new CustomEvent("ao_recognized",{detail:t});this.storageTemp.s=t.s||[],this.storageTemp.p=t.p||{},document.dispatchEvent(s)}if(t.cid){this.storage.cid=t.cid;const s=new CustomEvent("ao_cid",{detail:t.cid});document.dispatchEvent(s)}const s=new CustomEvent("ao_event_sent",{detail:t});document.dispatchEvent(s)}))}}const o=t.getInstance(window.arrigooHost||"http://localhost:3000"),a=new Event("ao_loaded");document.addEventListener("DOMContentLoaded",(()=>{window.argo=new n(o,localStorage),window.document.dispatchEvent(a)}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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ekQyQyxTQUFTNEMsY0FBY0MsRUFDM0IsQ0FDQSxNQUFNQyxFQUFTLElBQUlKLFlBQVksZ0JBQWlCLENBQUNDLE9BQVF4RixJQUN6RDZDLFNBQVM0QyxjQUFjRSxFQUFPLEdBRXRDLEVFMUhKLE1BQU1DLEVBQVk5RyxFQUFPRyxZQUFheUMsT0FBZW1FLGFBQWUseUJBRTlEQyxFQUFVLElBQUlDLE1BQU0sYUFFMUJsRCxTQUFTbUQsaUJBQWlCLG9CQUFvQixLQUN6Q3RFLE9BQWV1RSxLQUFPLElBQUk3RSxFQUFhd0UsRUFBV00sY0FDbkR4RSxPQUFPbUIsU0FBUzRDLGNBQWNLLEVBQVEsRyIsInNvdXJjZXMiOlsid2VicGFjazovL2Zyb250ZW5kLy4vc3JjL2NsaWVudC50cyIsIndlYnBhY2s6Ly9mcm9udGVuZC8uL3NyYy9icm93c2VyU3RvcmFnZS50cyIsIndlYnBhY2s6Ly9mcm9udGVuZC8uL3NyYy9hcnJpZ29vVXRpbHMudHMiLCJ3ZWJwYWNrOi8vZnJvbnRlbmQvLi9zcmMvdXRpbHMudHMiLCJ3ZWJwYWNrOi8vZnJvbnRlbmQvLi9zcmMvaW5kZXgudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgRXZlbnRJLCBDb25zZW50SSB9IGZyb20gXCIuL2ludGVyZmFjZXNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2xpZW50IHtcbiAgICBwcml2YXRlIHN0YXRpYyBpbnN0YW5jZTogQ2xpZW50O1xuICAgIHByaXZhdGUgaG9zdDogc3RyaW5nID0gXCJodHRwOi8vbG9jYWxob3N0OjMwMDBcIjtcbiAgICBwcml2YXRlIGNvbnN0cnVjdG9yKGhvc3Q/OiBzdHJpbmcpIHtcbiAgICAgICAgLy8gcHJpdmF0ZSB0byBwcmV2ZW50IG91dHNpZGUgaW5zdGFudGlhdGlvblxuICAgICAgICBpZiAoaG9zdCkge1xuICAgICAgICAgICAgdGhpcy5ob3N0ID0gaG9zdDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBzdGF0aWMgZ2V0SW5zdGFuY2UoaG9zdD86IHN0cmluZykge1xuICAgICAgICBpZiAoIUNsaWVudC5pbnN0YW5jZSkge1xuICAgICAgICAgICAgQ2xpZW50Lmluc3RhbmNlID0gbmV3IENsaWVudChob3N0KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gQ2xpZW50Lmluc3RhbmNlO1xuICAgIH1cbiAgICBwdWJsaWMgc2F2ZUV2ZW50KGV2ZW50OiBFdmVudEksIGNhbGxiYWNrPzogRnVuY3Rpb24pIHtcblxuICAgICAgICBmZXRjaChgJHt0aGlzLmhvc3R9L2V2ZW50YCwge21ldGhvZDogXCJQT1NUXCIsIGJvZHk6IEpTT04uc3RyaW5naWZ5KGV2ZW50KSwgaGVhZGVyczoge1wiQ29udGVudC10eXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLCBcIkFjY2VwdFwiOiBcImFwcGxpY2F0aW9uL2pzb25cIn19KS50aGVuKChyZXM6IGFueSkgPT57XG4gICAgICAgICAgICBpZiAocmVzLnN0YXR1cyA9PSAyMDApe1xuICAgICAgICAgICAgICAgIHJlcy5qc29uKCkudGhlbigoZGF0YTogYW55KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjYWxsYmFjaykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2soZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgIH1cblxuICAgIHB1YmxpYyBnZXRVc2VyRGF0YShjaWQ6IHN0cmluZywgY2FsbGJhY2s/OiBGdW5jdGlvbikge1xuICAgICAgICBmZXRjaChgJHt0aGlzLmhvc3R9L2N1c3RvbWVyLyR7Y2lkfWApLnRoZW4oKHJlczogYW55KSA9PiB7XG4gICAgICAgICAgICBpZiAocmVzLnN0YXR1cyA9PSAyMDApIHtcbiAgICAgICAgICAgICAgICByZXMuanNvbigpLnRoZW4oKGRhdGE6IGFueSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICB9XG59XG4iLCJjb25zdCBjZHA6IGFueSA9IHtcbiAgICBjaWQ6IG51bGwsXG4gICAgc2lkOiBudWxsXG59O1xuY29uc3Qgc3RvcmFnZUtleSA9ICdjZHBsaWdodCc7XG5jb25zdCBHZXRTdG9yYWdlID0gKHN0b3JhZ2U6IFN0b3JhZ2UpOiBTdG9yYWdlID0+IHtcbiAgICByZXR1cm4gbmV3IFByb3h5KGNkcCwge1xuICAgICAgc2V0OiAob2JqLCBwcm9wLCB2YWx1ZSkgPT4ge1xuICAgICAgICBjb25zdCBiYXNlVmFsdWUgPSBzdG9yYWdlLmdldEl0ZW0oc3RvcmFnZUtleSk7XG4gICAgICAgIG9iaiA9IGJhc2VWYWx1ZSA/IEpTT04ucGFyc2UoYXRvYihiYXNlVmFsdWUpKSA6IHt9O1xuICAgICAgICBpZiAodmFsdWUgPT09IG51bGwpIHtcbiAgICAgICAgICBvYmpbcHJvcCBhcyBzdHJpbmddID0gbnVsbDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBvYmpbcHJvcCBhcyBzdHJpbmddID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgc2F2ZWRWYWx1ZSA9IGJ0b2EoSlNPTi5zdHJpbmdpZnkob2JqKSk7XG4gICAgICAgIHN0b3JhZ2Uuc2V0SXRlbShzdG9yYWdlS2V5LCBzYXZlZFZhbHVlKTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9LFxuICAgICAgZ2V0OiAob2JqLCBwcm9wKSA9PiB7XG4gICAgICAgIGNvbnN0IGJhc2VWYWx1ZSA9IHN0b3JhZ2UuZ2V0SXRlbShzdG9yYWdlS2V5KTtcbiAgICAgICAgaWYgKCFiYXNlVmFsdWUpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBvYmogPSBiYXNlVmFsdWUgPyBKU09OLnBhcnNlKGF0b2IoYmFzZVZhbHVlKSkgOiB7fTtcbiAgICAgICAgaWYgKCFvYmpbcHJvcCBhcyBzdHJpbmddKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvYmpbcHJvcCBhcyBzdHJpbmddO1xuICAgICAgfSxcbiAgICB9KTtcbiAgfTtcbmV4cG9ydCBkZWZhdWx0IEdldFN0b3JhZ2U7XG4iLCJpbXBvcnQgeyBFdmVudEksIENvbnNlbnRJIH0gZnJvbSBcIi4vaW50ZXJmYWNlc1wiO1xuaW1wb3J0IGNkcENsaWVudCBmcm9tIFwiLi9jbGllbnRcIjtcbmltcG9ydCAgR2V0U3RvcmFnZSBmcm9tIFwiLi9icm93c2VyU3RvcmFnZVwiO1xuaW1wb3J0IHsgUGFyc2VRdWVyeSB9IGZyb20gXCIuL3V0aWxzXCI7XG5cbi8vIEdldCB0aGUgdmFsdWVzIHZhcmlvdXMgdmFsdWVzIGZyb20gdGhlIGJyb3dzZXJcbmV4cG9ydCBjbGFzcyBhcnJpZ29vVXRpbHMge1xuICAgIHByb3RlY3RlZCBpbml0OiBQYXJ0aWFsPEV2ZW50ST47XG4gICAgcHJvdGVjdGVkIGNsaWVudDogY2RwQ2xpZW50O1xuICAgIHByb3RlY3RlZCBzdG9yYWdlOiBTdG9yYWdlO1xuICAgIHB1YmxpYyBzdG9yYWdlVGVtcDogU3RvcmFnZTtcbiAgICBjb25zdHJ1Y3RvcihjbGllbnQ6IGNkcENsaWVudCwgc3RvcmFnZTogU3RvcmFnZSwgc3RvcmFnZVRlbXA/OiBTdG9yYWdlKSB7XG4gICAgICAgICh3aW5kb3cgYXMgYW55KS5hcnJpZ29vSW5pdCA9ICh3aW5kb3cgYXMgYW55KS5hcnJpZ29vSW5pdCB8fCB7fTtcbiAgICAgICAgdGhpcy5pbml0ID0gKHdpbmRvdyBhcyBhbnkpLmFycmlnb29Jbml0O1xuICAgICAgICB0aGlzLmNsaWVudCA9IGNsaWVudDtcbiAgICAgICAgdGhpcy5zdG9yYWdlID0gR2V0U3RvcmFnZShzdG9yYWdlKTtcbiAgICAgICAgdGhpcy5zdG9yYWdlLnB2ID0gdGhpcy5zdG9yYWdlLnB2ICsgMTtcbiAgICAgICAgdGhpcy5zdG9yYWdlVGVtcCA9IEdldFN0b3JhZ2Uoc3RvcmFnZVRlbXAgfHwgc2Vzc2lvblN0b3JhZ2UpO1xuICAgIH1cbiAgICBzZXQoa2V5OiBzdHJpbmcsIHZhbHVlOiBhbnkpIHtcbiAgICAgICAgdGhpcy5pbml0W2tleV0gPSB2YWx1ZTtcbiAgICB9XG4gICAgZ2V0KGtleTogc3RyaW5nKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnN0b3JhZ2VUZW1wW2tleV0gfHwgdGhpcy5zdG9yYWdlW2tleV07XG4gICAgfVxuICAgIGdldEZ1bGxQcm9maWxlKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgY2lkOiB0aGlzLnN0b3JhZ2UuY2lkLFxuICAgICAgICAgICAgcDogdGhpcy5zdG9yYWdlVGVtcC5wLFxuICAgICAgICAgICAgczogdGhpcy5zdG9yYWdlVGVtcC5zLFxuICAgICAgICAgICAgYzogdGhpcy5zdG9yYWdlVGVtcC5jLFxuICAgICAgICB9XG4gICAgfVxuICAgIHVuc2V0KGtleTogc3RyaW5nKSB7XG4gICAgICAgIGRlbGV0ZSB0aGlzLmluaXRba2V5XTtcbiAgICB9XG4gICAgZ2V0SW5pdCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaW5pdDtcbiAgICB9XG4gICAgZ2V0SGFzaFZhbHVlcygpIHtcbiAgICAgICAgcmV0dXJuIHdpbmRvdy5sb2NhdGlvbi5oYXNoO1xuICAgIH1cblxuICAgIGdldFNlYXJjaFZhbHVlKHBhcmFtOiBzdHJpbmcpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBVUkxTZWFyY2hQYXJhbXMod2luZG93LmxvY2F0aW9uLnNlYXJjaCB8fCAnJykuZ2V0KHBhcmFtKTtcbiAgICB9XG5cbiAgICBzZXRDaWRBbmRGaXJzdFZpc2l0KCk6IFBhcnRpYWw8RXZlbnRJPiB7XG4gICAgICAgIGNvbnN0IGV2ZW50OiBQYXJ0aWFsPEV2ZW50ST4gPSB7fTtcbiAgICAgICAgZXZlbnQuZnYgPSBmYWxzZTtcbiAgICAgICAgaWYgKCF0aGlzLnN0b3JhZ2UuY2lkKSB7XG4gICAgICAgICAgICB0aGlzLnN0b3JhZ2UuY2lkID0gXCJcIjtcbiAgICAgICAgICAgIGV2ZW50LmZ2ID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBldmVudC5jaWQgPSB0aGlzLnN0b3JhZ2UuY2lkO1xuICAgICAgICByZXR1cm4gZXZlbnQ7XG4gICAgfVxuICAgIFxuICAgIHNldFNlc3Npb24oZXZlbnQ6IFBhcnRpYWw8RXZlbnRJPik6IFBhcnRpYWw8RXZlbnRJPiB7XG4gICAgICAgIHRoaXMuc3RvcmFnZS5zY3QgPSB0aGlzLnN0b3JhZ2Uuc2N0ID8gdGhpcy5zdG9yYWdlLnNjdCArIDEgOiAxO1xuICAgICAgICBjb25zdCBsYXN0RXZlbnQgPSB0aGlzLnN0b3JhZ2UubGFzdEV2ZW50IHx8IDA7XG4gICAgICAgIGxldCBzaWQgPSB0aGlzLnN0b3JhZ2Uuc2lkO1xuICAgICAgICBldmVudC5ucyA9IGZhbHNlO1xuICAgICAgICAvLyBSZXNldCBzZXNzaW9uIGlmIG1vcmUgdGhhbiAzMCBtaW51dGVzIGhhdmUgcGFzc2VkLlxuICAgICAgICBjb25zdCBub3cgPSBNYXRoLmZsb29yKERhdGUubm93KCkgLyAxMDAwKTtcbiAgICAgICAgaWYgKCFzaWQgfHwgKG5vdyAtIGxhc3RFdmVudCA+IDE4MDApKSB7XG4gICAgICAgICAgICBzaWQgPSBub3c7XG4gICAgICAgICAgICB0aGlzLnN0b3JhZ2Uuc2lkID0gc2lkO1xuICAgICAgICAgICAgZXZlbnQubnMgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5zdG9yYWdlLnNjdCA9IDE7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zdG9yYWdlLmxhc3RFdmVudCA9IG5vdztcbiAgICAgICAgZXZlbnQuc2lkID0gc2lkO1xuICAgICAgICByZXR1cm4gZXZlbnQ7XG4gICAgfVxuXG4gICAgcHVibGljIGNvbnNlbnQoY29uc2VudDogQ29uc2VudEksIGNhbGxiYWNrPzogRnVuY3Rpb24pIHtcbiAgICAgICAgY29uc3QgYmFzZUV2ZW50ID0gdGhpcy5zZXRTZXNzaW9uKHRoaXMuc2V0Q2lkQW5kRmlyc3RWaXNpdCgpKTtcbiAgICAgICAgbGV0IHN0YXR1cyA9IDA7XG4gICAgICAgIGlmIChjb25zZW50LnN0YXR1cyA9PT0gJ0dSQU5UJykge1xuICAgICAgICAgICAgc3RhdHVzID0gMTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY29uc2VudC5zdGF0dXMgPT09ICdSRVZPS0UnKSB7XG4gICAgICAgICAgICBzdGF0dXMgPSAtMTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBldmVudDogRXZlbnRJID0ge1xuICAgICAgICAgICAgZXZ0OiBcImNvbnNlbnRcIixcbiAgICAgICAgICAgIHNyYzogY29uc2VudC50eXBlLFxuICAgICAgICAgICAgc3RydmFsOiBjb25zZW50LnNjb3BlLFxuICAgICAgICAgICAgaW50dmFsOiBzdGF0dXMsXG4gICAgICAgICAgICB1cmw6IHdpbmRvdy5sb2NhdGlvbi5ocmVmLFxuICAgICAgICAgICAgdG9waWNzOiBbY29uc2VudC50eXBlXSxcbiAgICAgICAgICAgIHNpZDogMCxcbiAgICAgICAgICAgIGNpZDogdGhpcy5zdG9yYWdlLmNpZCxcbiAgICAgICAgICAgIC4uLmJhc2VFdmVudFxuICAgICAgICB9XG4gICAgICAgIHRoaXMuY2xpZW50LnNhdmVFdmVudChldmVudCwgKGRhdGE6IGFueSkgPT4ge1xuICAgICAgICAgICAgaWYgKGNhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2soZGF0YSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHNlbmQoIGV2dDogc3RyaW5nLCBzdHI/OiBzdHJpbmcsIGV2ZW50Q29uZj86IEV2ZW50SSkge1xuICAgICAgICBjb25zdCBldmVudEJhc2UgPSB0aGlzLnNldFNlc3Npb24odGhpcy5zZXRDaWRBbmRGaXJzdFZpc2l0KCkpO1xuICAgICAgICBsZXQgYmFzZSA9IHtcbiAgICAgICAgICAgIGV2dCxcbiAgICAgICAgICAgIHN0cnZhbDogc3RyIHx8ICcnLFxuICAgICAgICAgICAgLi4uZXZlbnRCYXNlLFxuICAgICAgICAgICAgLi4uKGV2ZW50Q29uZiB8fCB7fSlcbiAgICAgICAgfTtcblxuICAgICAgICB0aGlzLmNsaWVudC5zYXZlRXZlbnQoYmFzZSBhcyBFdmVudEksIChkYXRhOiBhbnkpID0+IHtcbiAgICAgICAgICAgIC8vIFRyaWdnZXIgZXZlbnQgaWYgdGhlIHJlc3BvbnNlIGhhcyBwcm9wZXJ0aWVzLlxuICAgICAgICAgICAgaWYgKGRhdGEucCB8fCBkYXRhLnMpIHtcbiAgICAgICAgICAgICAgICBjb25zdCByZWNFdmVudCA9IG5ldyBDdXN0b21FdmVudCgnYW9fcmVjb2duaXplZCcsIHtkZXRhaWw6IGRhdGF9KTtcbiAgICAgICAgICAgICAgICB0aGlzLnN0b3JhZ2VUZW1wLnMgPSBkYXRhLnMgfHwgW107XG4gICAgICAgICAgICAgICAgdGhpcy5zdG9yYWdlVGVtcC5wID0gZGF0YS5wIHx8IHt9O1xuICAgICAgICAgICAgICAgIGRvY3VtZW50LmRpc3BhdGNoRXZlbnQocmVjRXZlbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGRhdGEuY2lkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zdG9yYWdlLmNpZCA9IGRhdGEuY2lkO1xuICAgICAgICAgICAgICAgIGNvbnN0IGNpZEV2ZW50ID0gbmV3IEN1c3RvbUV2ZW50KCdhb19jaWQnLCB7ZGV0YWlsOiBkYXRhLmNpZH0pO1xuICAgICAgICAgICAgICAgIGRvY3VtZW50LmRpc3BhdGNoRXZlbnQoY2lkRXZlbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgYkV2ZW50ID0gbmV3IEN1c3RvbUV2ZW50KCdhb19ldmVudF9zZW50Jywge2RldGFpbDogZGF0YX0pO1xuICAgICAgICAgICAgZG9jdW1lbnQuZGlzcGF0Y2hFdmVudChiRXZlbnQpO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIHNlbmRJbml0RXZlbnQgPSAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHB2UHJvcHMgPSAod2luZG93IGFzIGFueSkuYXJnb2luaXQgfHwge307XG4gICAgICAgIGNvbnN0IHF1ZXJ5ID0gUGFyc2VRdWVyeSh3aW5kb3cubG9jYXRpb24uc2VhcmNoKTtcbiAgICAgICAgY29uc3Qgc3JjID0gcXVlcnkuc291cmNlIHx8IChxdWVyeS5nY2xpZCA/ICdhZCcgOiAnd2ViJyk7XG4gICAgICAgIGNvbnN0IGRlZmF1bHRFdmVudCA9IHtcbiAgICAgICAgICAgIGV2dDogJ3BhZ2V2aWV3JyxcbiAgICAgICAgICAgIHN0cnZhbDogZG9jdW1lbnQudGl0bGUsXG4gICAgICAgICAgICBpbnR2YWw6IHRoaXMuc3RvcmFnZS5wdixcbiAgICAgICAgICAgIHNyYyxcbiAgICAgICAgICAgIHVybDogd2luZG93LmxvY2F0aW9uLmhyZWYsXG4gICAgICAgICAgICByZWY6IGRvY3VtZW50LnJlZmVycmVyICsgJycsXG4gICAgICAgICAgICAuLi5wdlByb3BzXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuc2VuZCgncGFnZXZpZXcnLCBkb2N1bWVudC50aXRsZSwgZGVmYXVsdEV2ZW50KTtcbiAgICB9XG59XG4iLCJcblxuZXhwb3J0IGNvbnN0IFBhcnNlUXVlcnkgPSAocXVlcnlTdHJpbmc6IHN0cmluZyk6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPT4ge1xuICAgIGNvbnN0IG1hdGNoZXMgPSBxdWVyeVN0cmluZy5tYXRjaEFsbCgvKFthLXpBLVpdKyk9KFteJl0rKS9naSk7XG4gICAgbGV0IHA6IEl0ZXJhdG9yUmVzdWx0PFJlZ0V4cE1hdGNoQXJyYXksIHN0cmluZz47XG4gICAgY29uc3QgcmVzdWx0OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge307XG4gICAgd2hpbGUgKChwID0gbWF0Y2hlcy5uZXh0KCkpKSB7XG4gICAgICBpZiAocC5kb25lKSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgcmVzdWx0W3AudmFsdWVbMV1dID0gcC52YWx1ZVsyXTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn07XG4iLCJpbXBvcnQgQ2xpZW50IGZyb20gXCIuL2NsaWVudFwiO1xuaW1wb3J0IEdldFN0b3JhZ2UgZnJvbSBcIi4vYnJvd3NlclN0b3JhZ2VcIjtcbmltcG9ydCB7IEV2ZW50SSB9IGZyb20gXCIuL2ludGVyZmFjZXNcIjtcbmltcG9ydCB7IGFycmlnb29VdGlscyB9IGZyb20gXCIuL2Fycmlnb29VdGlsc1wiO1xuaW1wb3J0IHsgUGFyc2VRdWVyeSB9IGZyb20gXCIuL3V0aWxzXCI7XG5cbmNvbnN0IGNkcENsaWVudCA9IENsaWVudC5nZXRJbnN0YW5jZSgod2luZG93IGFzIGFueSkuYXJyaWdvb0hvc3QgfHwgJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMCcpO1xubGV0IHN0b3JhZ2U6IFN0b3JhZ2U7XG5jb25zdCBhbEV2ZW50ID0gbmV3IEV2ZW50KCdhb19sb2FkZWQnKTtcbi8vIFNlbmQgYW4gZXZlbnQgdG8gdGhlIHNlcnZlci4gUG9wdWxhdGUgd2l0aCBwcmVwYXJhdGlvbiBmdW5jdGlvbnMuXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgKCkgPT4ge1xuICAgICh3aW5kb3cgYXMgYW55KS5hcmdvID0gbmV3IGFycmlnb29VdGlscyhjZHBDbGllbnQsIGxvY2FsU3RvcmFnZSk7XG4gICAgd2luZG93LmRvY3VtZW50LmRpc3BhdGNoRXZlbnQoYWxFdmVudCk7XG59KTtcbiJdLCJuYW1lcyI6WyJDbGllbnQiLCJob3N0IiwidGhpcyIsImdldEluc3RhbmNlIiwiaW5zdGFuY2UiLCJzYXZlRXZlbnQiLCJldmVudCIsImNhbGxiYWNrIiwiZmV0Y2giLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImhlYWRlcnMiLCJ0aGVuIiwicmVzIiwic3RhdHVzIiwianNvbiIsImRhdGEiLCJnZXRVc2VyRGF0YSIsImNpZCIsImNkcCIsInNpZCIsInN0b3JhZ2VLZXkiLCJzdG9yYWdlIiwiUHJveHkiLCJzZXQiLCJvYmoiLCJwcm9wIiwidmFsdWUiLCJiYXNlVmFsdWUiLCJnZXRJdGVtIiwicGFyc2UiLCJhdG9iIiwic2F2ZWRWYWx1ZSIsImJ0b2EiLCJzZXRJdGVtIiwiZ2V0IiwiYXJyaWdvb1V0aWxzIiwiY29uc3RydWN0b3IiLCJjbGllbnQiLCJzdG9yYWdlVGVtcCIsInNlbmRJbml0RXZlbnQiLCJwdlByb3BzIiwid2luZG93IiwiYXJnb2luaXQiLCJxdWVyeSIsInF1ZXJ5U3RyaW5nIiwibWF0Y2hlcyIsImxvY2F0aW9uIiwic2VhcmNoIiwibWF0Y2hBbGwiLCJwIiwicmVzdWx0IiwibmV4dCIsImRvbmUiLCJQYXJzZVF1ZXJ5Iiwic3JjIiwic291cmNlIiwiZ2NsaWQiLCJkZWZhdWx0RXZlbnQiLCJldnQiLCJzdHJ2YWwiLCJkb2N1bWVudCIsInRpdGxlIiwiaW50dmFsIiwicHYiLCJ1cmwiLCJocmVmIiwicmVmIiwicmVmZXJyZXIiLCJzZW5kIiwiYXJyaWdvb0luaXQiLCJpbml0Iiwic2Vzc2lvblN0b3JhZ2UiLCJrZXkiLCJnZXRGdWxsUHJvZmlsZSIsInMiLCJjIiwidW5zZXQiLCJnZXRJbml0IiwiZ2V0SGFzaFZhbHVlcyIsImhhc2giLCJnZXRTZWFyY2hWYWx1ZSIsInBhcmFtIiwiVVJMU2VhcmNoUGFyYW1zIiwic2V0Q2lkQW5kRmlyc3RWaXNpdCIsImZ2Iiwic2V0U2Vzc2lvbiIsInNjdCIsImxhc3RFdmVudCIsIm5zIiwibm93IiwiTWF0aCIsImZsb29yIiwiRGF0ZSIsImNvbnNlbnQiLCJiYXNlRXZlbnQiLCJ0eXBlIiwic2NvcGUiLCJ0b3BpY3MiLCJzdHIiLCJldmVudENvbmYiLCJiYXNlIiwicmVjRXZlbnQiLCJDdXN0b21FdmVudCIsImRldGFpbCIsImRpc3BhdGNoRXZlbnQiLCJjaWRFdmVudCIsImJFdmVudCIsImNkcENsaWVudCIsImFycmlnb29Ib3N0IiwiYWxFdmVudCIsIkV2ZW50IiwiYWRkRXZlbnRMaXN0ZW5lciIsImFyZ28iLCJsb2NhbFN0b3JhZ2UiXSwic291cmNlUm9vdCI6IiJ9