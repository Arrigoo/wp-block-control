(()=>{"use strict";const e=window.wp.hooks,t=window.wp.i18n,o=window.wp.blockEditor,n=window.wp.components,r=(window.wp.element,window.ReactJSXRuntime);(0,e.addFilter)("editor.BlockEdit","arrigoo-cdp/arrigoo-segment-block-control-script",(function(e){return s=>{const{attributes:l,setAttributes:i}=s,c=window.arrigooCdpSegments||[],a=l.selectedSegments||[],d=(e,t)=>{if((t=t||[]).includes(e)){const o=t.filter((t=>t!==e));return console.log("removing segment",e,o),o}const o=[...t,e];return console.log("adding segment",e,o),o};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e,{...s}),(0,r.jsx)(o.InspectorControls,{children:(0,r.jsx)(n.PanelBody,{title:(0,t.__)("CDP Segment control","arrigoo-segment-block-control-script"),children:(0,r.jsx)(n.PanelRow,{children:c.map((e=>(0,r.jsx)("div",{children:(0,r.jsx)(n.CheckboxControl,{label:e.title,checked:a?.includes(e.sys_title),onChange:t=>{console.log(l);const o={...l};i({...o,selectedSegments:d(e.sys_title,a)})}})},e.sys_title)))})})})]})}})),r.Fragment,(0,t.__)("Select the segments from the CDP that are allowed to see the block. If no segments are selected, the block will be visible to everyone.","arrigoo-segment-block-control-script"),n.ExternalLink,(0,t.__)("Learn more about segments.","arrigoo-segment-block-control"),(0,e.addFilter)("blocks.registerBlockType","arrigoo-cdp/add-cdp-segments-attribute",(function(e,t){return e.attributes={...e.attributes,selectedSegments:{type:"array",default:[]}},e})),(0,e.addFilter)("blocks.getSaveContent.extraProps","arrigoo-cdp/arrigoo-segment-block-control-filter",(function(e,t,o){const{name:n}=t,{selectedSegments:r}=o;if(r&&r.length>0){const t=e.class||[];return t.push("arrigoo-segment-block"),{...e,"data-segments":r.join(" "),class:t}}return e}))})();